{

"annotations": {

"list": [

{

"builtIn": 1,

"datasource": {

"type": "grafana",

"uid": "-- Grafana --"

},

"enable": true,

"hide": true,

"iconColor": "rgba(0, 211, 255, 1)",

"name": "Annotations & Alerts",

"type": "dashboard"

}

]

},

"editable": true,

"fiscalYearStartMonth": 0,

"graphTooltip": 1,

"id": 1,

"links": [],

"panels": [

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"fieldConfig": {

"defaults": {

"color": {

"mode": "continuous-GrYlRd"

},

"custom": {

"axisBorderShow": false,

"axisCenteredZero": false,

"axisColorMode": "text",

"axisLabel": "",

"axisPlacement": "auto",

"fillOpacity": 80,

"gradientMode": "none",

"hideFrom": {

"legend": false,

"tooltip": false,

"viz": false

},

"lineWidth": 1,

"scaleDistribution": {

"type": "linear"

},

"thresholdsStyle": {

"mode": "off"

}

},

"mappings": [],

"thresholds": {

"mode": "absolute",

"steps": [

{

"color": "green",

"value": null

},

{

"color": "red",

"value": 80

}

]

},

"unit": "s"

},

"overrides": [

{

"matcher": {

"id": "byName",

"options": "time_init"

},

"properties": [

{

"id": "color",

"value": {

"fixedColor": "light-purple",

"mode": "fixed"

}

}

]

},

{

"matcher": {

"id": "byName",

"options": "time_pending"

},

"properties": [

{

"id": "color",

"value": {

"fixedColor": "semi-dark-blue",

"mode": "fixed"

}

}

]

}

]

},

"gridPos": {

"h": 9,

"w": 24,

"x": 0,

"y": 0

},

"hideTimeOverride": false,

"id": 17,

"options": {

"barRadius": 0,

"barWidth": 0.97,

"fullHighlight": false,

"groupWidth": 0.7,

"legend": {

"calcs": [

"max",

"mean"

],

"displayMode": "table",

"placement": "right",

"showLegend": true

},

"orientation": "auto",

"showValue": "never",

"stacking": "normal",

"tooltip": {

"mode": "single",

"sort": "none"

},

"xField": "datetime_start",

"xTickLabelRotation": 0,

"xTickLabelSpacing": 0

},

"pluginVersion": "11.1.3",

"targets": [

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"editorMode": "code",

"format": "table",

"rawQuery": true,

"rawSql": "select\n job_details :: jsonb -> 'metrics' -> 'time_init' as time_init,\n job_details :: jsonb -> 'metrics' -> 'time_pending' as time_pending,\n extract(seconds from (datetime_end - datetime_start)),\n datetime_start\n from\n user_workspaces_server_job\nwhere datetime_start >= current_date - interval '1' year\norder by datetime_start;",

"refId": "A",

"sql": {

"columns": [

{

"parameters": [],

"type": "function"

}

],

"groupBy": [

{

"property": {

"type": "string"

},

"type": "groupBy"

}

],

"limit": 50

},

"table": "user_workspaces_server_job"

}

],

"title": "Panel Title",

"transformations": [

{

"id": "convertFieldType",

"options": {

"conversions": [

{

"destinationType": "number",

"targetField": "time_init"

},

{

"destinationType": "number",

"targetField": "time_pending"

},

{

"destinationType": "number",

"targetField": "extract"

},

{

"dateFormat": "YYYY-MM-DD HH:MM:SS",

"destinationType": "time",

"targetField": "datetime_start"

}

],

"fields": {}

}

},

{

"id": "filterByValue",

"options": {

"filters": [

{

"config": {

"id": "greater",

"options": {

"value": 1000

}

},

"fieldName": "time_init"

},

{

"config": {

"id": "greater",

"options": {

"value": 100

}

},

"fieldName": "time_pending"

}

],

"match": "any",

"type": "exclude"

}

},

{

"id": "organize",

"options": {

"excludeByName": {},

"includeByName": {},

"indexByName": {},

"renameByName": {

"extract": "Run time",

"id": "Job ID",

"time_init": "Init time",

"time_pending": "Pending time"

}

}

}

],

"type": "barchart"

},

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"fieldConfig": {

"defaults": {

"color": {

"fixedColor": "super-light-orange",

"mode": "shades"

},

"custom": {

"fillOpacity": 60,

"gradientMode": "hue",

"hideFrom": {

"legend": false,

"tooltip": false,

"viz": false

},

"lineWidth": 1,

"stacking": {

"group": "A",

"mode": "none"

}

},

"displayName": "Init time",

"fieldMinMax": false,

"mappings": [],

"thresholds": {

"mode": "absolute",

"steps": [

{

"color": "green",

"value": null

},

{

"color": "red",

"value": 80

}

]

},

"unit": "s"

},

"overrides": []

},

"gridPos": {

"h": 11,

"w": 24,

"x": 0,

"y": 9

},

"id": 16,

"options": {

"combine": false,

"legend": {

"calcs": [

"max",

"mean"

],

"displayMode": "table",

"placement": "right",

"showLegend": true

}

},

"pluginVersion": "11.1.3",

"targets": [

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"editorMode": "code",

"format": "table",

"rawQuery": true,

"rawSql": "select job_details::jsonb->'metrics'->'time_init' as time_init from user_workspaces_server_job where job_details::jsonb->'metrics'->'time_init' is not null;",

"refId": "A",

"sql": {

"columns": [

{

"parameters": [],

"type": "function"

}

],

"groupBy": [

{

"property": {

"type": "string"

},

"type": "groupBy"

}

],

"limit": 50

}

}

],

"title": "Workspace initialization time",

"transformations": [

{

"id": "convertFieldType",

"options": {

"conversions": [

{

"destinationType": "number",

"targetField": "time_init"

}

],

"fields": {}

}

}

],

"type": "histogram"

},

{

"collapsed": true,

"gridPos": {

"h": 1,

"w": 24,

"x": 0,

"y": 20

},

"id": 14,

"panels": [

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"description": "",

"fieldConfig": {

"defaults": {

"color": {

"fixedColor": "blue",

"mode": "continuous-YlRd"

},

"fieldMinMax": false,

"mappings": [],

"thresholds": {

"mode": "absolute",

"steps": [

{

"color": "green"

},

{

"color": "red",

"value": 80

}

]

}

},

"overrides": [

{

"matcher": {

"id": "byRegexp",

"options": ".*count.*"

},

"properties": [

{

"id": "unit",

"value": "none"

}

]

},

{

"matcher": {

"id": "byRegexp",

"options": ".*mean.*"

},

"properties": [

{

"id": "unit",

"value": "s"

}

]

}

]

},

"gridPos": {

"h": 8,

"w": 12,

"x": 0,

"y": 17

},

"id": 13,

"options": {

"displayMode": "lcd",

"maxVizHeight": 300,

"minVizHeight": 16,

"minVizWidth": 8,

"namePlacement": "auto",

"orientation": "horizontal",

"reduceOptions": {

"calcs": [],

"fields": "",

"values": true

},

"showUnfilled": true,

"sizing": "auto",

"valueMode": "color"

},

"pluginVersion": "11.1.3",

"targets": [

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"editorMode": "code",

"format": "table",

"rawQuery": true,

"rawSql": "select extract(epoch from (datetime_end-datetime_start)) as delta, job_type from user_workspaces_server_job;",

"refId": "A",

"sql": {

"columns": [

{

"parameters": [

{

"name": "datetime_start",

"type": "functionParameter"

}

],

"type": "function"

},

{

"parameters": [

{

"name": "datetime_end",

"type": "functionParameter"

}

],

"type": "function"

},

{

"parameters": [

{

"name": "job_type",

"type": "functionParameter"

}

],

"type": "function"

}

],

"groupBy": [

{

"property": {

"type": "string"

},

"type": "groupBy"

}

],

"limit": 50

},

"table": "user_workspaces_server_job"

}

],

"title": "Average job duration",

"transformations": [

{

"id": "groupBy",

"options": {

"fields": {

"delta": {

"aggregations": [

"mean"

],

"operation": "aggregate"

},

"job_type": {

"aggregations": [],

"operation": "groupby"

}

}

}

}

],

"type": "bargauge"

},

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"fieldConfig": {

"defaults": {

"color": {

"mode": "continuous-GrYlRd"

},

"mappings": [],

"thresholds": {

"mode": "absolute",

"steps": [

{

"color": "light-purple"

}

]

}

},

"overrides": []

},

"gridPos": {

"h": 8,

"w": 12,

"x": 12,

"y": 17

},

"id": 15,

"options": {

"displayMode": "lcd",

"maxVizHeight": 300,

"minVizHeight": 16,

"minVizWidth": 8,

"namePlacement": "auto",

"orientation": "horizontal",

"reduceOptions": {

"calcs": [],

"fields": "",

"values": true

},

"showUnfilled": true,

"sizing": "auto",

"valueMode": "color"

},

"pluginVersion": "11.1.3",

"targets": [

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"editorMode": "code",

"format": "table",

"rawQuery": true,

"rawSql": "select id, job_type from user_workspaces_server_job;",

"refId": "A",

"sql": {

"columns": [

{

"parameters": [],

"type": "function"

}

],

"groupBy": [

{

"property": {

"type": "string"

},

"type": "groupBy"

}

],

"limit": 50

}

}

],

"title": "Jobs per job_type",

"transformations": [

{

"id": "groupBy",

"options": {

"fields": {

"id": {

"aggregations": [

"count"

],

"operation": "aggregate"

},

"job_type": {

"aggregations": [],

"operation": "groupby"

}

}

}

}

],

"type": "bargauge"

},

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"fieldConfig": {

"defaults": {

"color": {

"mode": "continuous-GrYlRd"

},

"mappings": [],

"thresholds": {

"mode": "absolute",

"steps": [

{

"color": "green"

},

{

"color": "red",

"value": 80

}

]

}

},

"overrides": []

},

"gridPos": {

"h": 8,

"w": 12,

"x": 0,

"y": 25

},

"id": 12,

"options": {

"displayMode": "basic",

"maxVizHeight": 300,

"minVizHeight": 16,

"minVizWidth": 8,

"namePlacement": "auto",

"orientation": "horizontal",

"reduceOptions": {

"calcs": [],

"fields": "",

"values": true

},

"showUnfilled": true,

"sizing": "auto",

"valueMode": "color"

},

"pluginVersion": "11.1.3",

"targets": [

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"editorMode": "code",

"format": "table",

"rawQuery": true,

"rawSql": "select count(*) as c, a.username from user_workspaces_server_job w join auth_user a on a.id = w.user_id_id group by a.username order by c desc;\n",

"refId": "A",

"sql": {

"columns": [

{

"parameters": [],

"type": "function"

}

],

"groupBy": [

{

"property": {

"type": "string"

},

"type": "groupBy"

}

],

"limit": 50

}

}

],

"title": "Jobs by user",

"type": "bargauge"

}

],

"title": "Experimental",

"type": "row"

},

{

"collapsed": false,

"gridPos": {

"h": 1,

"w": 24,

"x": 0,

"y": 21

},

"id": 10,

"panels": [],

"title": "Total workspaces",

"type": "row"

},

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"fieldConfig": {

"defaults": {

"color": {

"mode": "thresholds"

},

"mappings": [],

"thresholds": {

"mode": "absolute",

"steps": [

{

"color": "green",

"value": null

},

{

"color": "red",

"value": 80

}

]

}

},

"overrides": []

},

"gridPos": {

"h": 8,

"w": 12,

"x": 0,

"y": 22

},

"id": 7,

"options": {

"colorMode": "value",

"graphMode": "area",

"justifyMode": "auto",

"orientation": "auto",

"percentChangeColorMode": "standard",

"reduceOptions": {

"calcs": [

"lastNotNull"

],

"fields": "",

"values": false

},

"showPercentChange": false,

"textMode": "auto",

"wideLayout": true

},

"pluginVersion": "11.1.3",

"targets": [

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"editorMode": "code",

"format": "table",

"rawQuery": true,

"rawSql": "select count(id) from user_workspaces_server_workspace ;",

"refId": "A",

"sql": {

"columns": [

{

"parameters": [],

"type": "function"

}

],

"groupBy": [

{

"property": {

"type": "string"

},

"type": "groupBy"

}

],

"limit": 50

}

}

],

"title": "Total workspaces created",

"type": "stat"

},

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"description": "Count of workspaces created by year.",

"fieldConfig": {

"defaults": {

"color": {

"mode": "thresholds"

},

"custom": {

"axisBorderShow": false,

"axisCenteredZero": false,

"axisColorMode": "text",

"axisLabel": "",

"axisPlacement": "auto",

"fillOpacity": 80,

"gradientMode": "none",

"hideFrom": {

"legend": false,

"tooltip": false,

"viz": false

},

"lineWidth": 1,

"scaleDistribution": {

"type": "linear"

},

"thresholdsStyle": {

"mode": "off"

}

},

"mappings": [],

"thresholds": {

"mode": "absolute",

"steps": [

{

"color": "super-light-blue",

"value": null

},

{

"color": "light-blue",

"value": 5

},

{

"color": "blue",

"value": 15

}

]

}

},

"overrides": []

},

"gridPos": {

"h": 8,

"w": 12,

"x": 12,

"y": 22

},

"id": 6,

"options": {

"barRadius": 0,

"barWidth": 0.97,

"colorByField": "count",

"fullHighlight": false,

"groupWidth": 0.7,

"legend": {

"calcs": [],

"displayMode": "list",

"placement": "bottom",

"showLegend": false

},

"orientation": "auto",

"showValue": "auto",

"stacking": "none",

"tooltip": {

"mode": "single",

"sort": "none"

},

"xField": "a",

"xTickLabelRotation": 0,

"xTickLabelSpacing": 0

},

"pluginVersion": "11.1.3",

"targets": [

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"editorMode": "code",

"format": "table",

"rawQuery": true,

"rawSql": "select count(id), extract(year from datetime_created) as a from user_workspaces_server_workspace GROUP BY extract(year from datetime_created) order by a;",

"refId": "A",

"sql": {

"columns": [

{

"parameters": [

{

"name": "datetime_created",

"type": "functionParameter"

}

],

"type": "function"

},

{

"name": "COUNT",

"parameters": [

{

"name": "id",

"type": "functionParameter"

}

],

"type": "function"

}

],

"groupBy": [

{

"property": {

"name": "datetime_created",

"type": "string"

},

"type": "groupBy"

},

{

"property": {

"name": "id",

"type": "string"

},

"type": "groupBy"

}

],

"limit": 50

},

"table": "user_workspaces_server_workspace"

}

],

"title": "Workspaces created",

"transformations": [

{

"id": "organize",

"options": {

"excludeByName": {},

"includeByName": {},

"indexByName": {},

"renameByName": {

"a": "year_created"

}

}

}

],

"type": "barchart"

},

{

"collapsed": false,

"gridPos": {

"h": 1,

"w": 24,

"x": 0,

"y": 30

},

"id": 9,

"panels": [],

"title": "User interactions",

"type": "row"

},

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"description": "Of all users, count of those who have launched at least one workspace vs. those who have not.",

"fieldConfig": {

"defaults": {

"color": {

"mode": "palette-classic"

},

"custom": {

"hideFrom": {

"legend": false,

"tooltip": false,

"viz": false

}

},

"fieldMinMax": false,

"mappings": []

},

"overrides": [

{

"matcher": {

"id": "byName",

"options": "No workspaces"

},

"properties": [

{

"id": "color",

"value": {

"fixedColor": "semi-dark-yellow",

"mode": "fixed"

}

}

]

}

]

},

"gridPos": {

"h": 8,

"w": 12,

"x": 0,

"y": 31

},

"id": 11,

"options": {

"displayLabels": [

"value"

],

"legend": {

"displayMode": "list",

"placement": "right",

"showLegend": true,

"values": [

"percent"

]

},

"pieType": "donut",

"reduceOptions": {

"calcs": [

"allValues"

],

"fields": "/^count$/",

"values": true

},

"tooltip": {

"mode": "single",

"sort": "none"

}

},

"pluginVersion": "11.1.3",

"targets": [

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"editorMode": "code",

"format": "table",

"rawQuery": true,

"rawSql": "select count(distinct(a.id)),\ncase when w.user_id_id is null then 'No workspaces' else '1 or more workspaces' end as has_workspace\nfrom \nauth_user a \nfull outer join user_workspaces_server_workspace w on w.user_id_id = a.id\ngroup by has_workspace;",

"refId": "A",

"sql": {

"columns": [

{

"parameters": [],

"type": "function"

}

],

"groupBy": [

{

"property": {

"type": "string"

},

"type": "groupBy"

}

],

"limit": 50

}

}

],

"title": "Users who have created workspaces",

"type": "piechart"

},

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"fieldConfig": {

"defaults": {

"color": {

"mode": "thresholds"

},

"mappings": [],

"thresholds": {

"mode": "absolute",

"steps": [

{

"color": "super-light-yellow",

"value": null

},

{

"color": "light-green",

"value": 5

},

{

"color": "light-blue",

"value": 10

}

]

}

},

"overrides": []

},

"gridPos": {

"h": 8,

"w": 12,

"x": 12,

"y": 31

},

"id": 8,

"options": {

"displayMode": "gradient",

"maxVizHeight": 300,

"minVizHeight": 16,

"minVizWidth": 8,

"namePlacement": "auto",

"orientation": "horizontal",

"reduceOptions": {

"calcs": [

"uniqueValues"

],

"fields": "",

"values": true

},

"showUnfilled": true,

"sizing": "auto",

"valueMode": "color"

},

"pluginVersion": "11.1.3",

"targets": [

{

"datasource": {

"type": "grafana-postgresql-datasource",

"uid": "user_workspaces_postgres"

},

"editorMode": "code",

"format": "table",

"rawQuery": true,

"rawSql": "select distinct(auth_user.username) as unique_users, count(user_workspaces_server_workspace.id) from user_workspaces_server_workspace inner join auth_user on user_workspaces_server_workspace.user_id_id=auth_user.id group by unique_users order by count(user_workspaces_server_workspace.id) desc;",

"refId": "A",

"sql": {

"columns": [

{

"parameters": [],

"type": "function"

}

],

"groupBy": [

{

"property": {

"type": "string"

},

"type": "groupBy"

}

],

"limit": 50

}

}

],

"title": "Workspaces by user",

"type": "bargauge"

}

],

"refresh": "",

"schemaVersion": 39,

"tags": [],

"templating": {

"list": []

},


"timepicker": {

"refresh_intervals": [],

"time_options": []

},

"timezone": "browser",

"title": "User Workspaces Server Stats",

"uid": "cLV5GDCkz",

"version": 1,

"weekStart": ""

}
